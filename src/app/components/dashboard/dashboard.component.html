<div class="dashboard-container">
  <!-- Header -->
  <div class="header">
    <div class="header-left">
      <h1>Binance Bot Dashboard</h1>
      <p class="subtitle">Monitoraggio Multi-Simbolo in Tempo Reale</p>
    </div>
    <div class="header-right">
      <div class="connection-status" [class.connected]="wsOpen">
        <span class="status-dot"></span>
        {{ wsOpen ? 'CONNESSO' : 'DISCONNESSO' }}
      </div>
    </div>
  </div>

  <!-- Symbol Selector -->
  <app-symbol-selector (symbolsChange)="onSymbolsChange($event)"></app-symbol-selector>

  <!-- Alert Manager -->
  <app-alert-manager></app-alert-manager>

  <!-- Controls -->
  <div class="controls-section">
    <div class="symbols-info">
      <strong>Simboli attivi:</strong>
      <span class="active-symbols">{{ symbolsInput || 'nessuno' }}</span>
      â€¢
      <span class="symbols-count">{{ getActiveSymbolsCount() }} simboli</span>
    </div>

    <div class="buttons-group">
      <button
        class="btn btn-primary"
        (click)="start()"
        [disabled]="wsOpen || !symbolsInput"
        [class.loading]="isConnecting"
      >
        {{ isConnecting ? 'CONNESSIONE...' : (wsOpen ? 'CONNESSO' : 'CONNETTI WS') }}
      </button>

      <button class="btn btn-secondary" (click)="refresh()" [disabled]="!symbolsInput">
        AGGIORNA DATI
      </button>

      <button class="btn btn-danger" (click)="stop()" [disabled]="!wsOpen">
        DISCONNETTI
      </button>
    </div>
  </div>

  <!-- Statistics -->
  <div class="stats-section">
    <div class="stat-card">
      <span class="stat-label">Simboli Attivi</span>
      <span class="stat-value">{{ getActiveSymbolsCount() }}</span>
    </div>
    <div class="stat-card">
      <span class="stat-label">Messaggi Ricevuti</span>
      <span class="stat-value">{{ messagesReceived }}</span>
    </div>
    <div class="stat-card">
      <span class="stat-label">Ultimo Aggiornamento</span>
      <span class="stat-value">{{ lastUpdate | date:'HH:mm:ss' }}</span>
    </div>
  </div>

  <!-- Charts (seguono i simboli selezionati, max 2) -->
  <div class="charts-section">
    <ng-container *ngFor="let sym of chartSymbols()">
      <app-price-chart
  *ngIf="getPriceHistory(sym).length > 0"
  [title]="(sym.toUpperCase()) + ' Price History'"
  [data]="getPriceHistory(sym)"
  [labels]="chartLabels()"
  [symbol]="sym.toUpperCase()">
</app-price-chart>
    </ng-container>
  </div>

  <!-- MiniTicker Table: collegata alla selezione -->
  <app-mini-ticker-table
    [tickers]="miniTickers()"
    [title]="'Dati in Tempo Reale (' + symbolsInput + ')'">
  </app-mini-ticker-table>

  <!-- Live Feed -->
  <div class="feed-section">
    <div class="feed-header">
      <h3>Live WebSocket Feed</h3>
      <button class="btn btn-sm" (click)="clearFeed()">Clear</button>
    </div>
    <div class="feed-container">
      <pre class="feed-content">{{ lastMsg | json }}</pre>
    </div>
  </div>
</div>
